<!doctype html>
<html lang="en"><head><meta charset="utf-8">
    <meta name="robots" content="noindex">
    <title>Task {{task_id}}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="format-detection" content="telephone=no">
    <link media="all" rel="stylesheet" type="text/css" href="/static/page_shared.css">
    <link media="all" rel="stylesheet" type="text/css" href="/static/page_inspect_task.css">
</head>

<body>
    <header class="titlebar-container">
    <div class="titlebar-item titlebar-item-left">
        <a class="seconday-button" href="{{ tasklist_href }}">Task list</a>
    </div>
    
    <div class="titlebar-item titlebar-item-center">Task {{task_id}}</div>
    
    <div class="titlebar-item titlebar-item-right">
        <a class="seconday-button" href="{{ node_href }}">Graph</a>
    </div>
    </header>
    
    <main id="main-outer">
    <div id="main-inner">
        <div class="themearc image" data-image>
            <span class="json-data">[[1, 2, 3], [4, 5, 6]]</span>
        </div>

        {{inspect_html|safe}}</div>
    </main>
    
    <footer id="page-footer">
    <div id="page-footer-item0" class="page-footer-item">
        <!-- footer -->
    </div>
    <div id="page-footer-item1" class="page-footer-item">
        <!-- footer -->
    </div>
    </footer>

      <script>
        const imageDivs = document.querySelectorAll('[data-image]');
      
        Array.from(imageDivs).forEach((imageDiv) => {
          const divs = imageDiv.querySelectorAll('.json-data');
          const div = divs[0];
          const json = div.innerText;
          const imageRows = JSON.parse(json);

          const spanRowContainer = document.createElement('span');
          spanRowContainer.className = 'themearc image rows';

          imageRows.forEach((row, rowIndex) => {
            const spanRow = document.createElement('span');
            spanRow.className = 'themearc image row';
      
            row.forEach((pixel, columnIndex) => {
              const spanPixel = document.createElement('span');
              spanPixel.className = `themearc symbol_${pixel}`;
              spanPixel.textContent = pixel;
              spanPixel.addEventListener('click', () => {
                const host = window.location.href;
                const url = `${host}/find-node-pixel?x=${columnIndex}&y=${rowIndex}`;
                window.open(url, '_blank');
              });
              spanRow.appendChild(spanPixel);
            });
      
            spanRowContainer.appendChild(spanRow);
          });

          const divRowContainer = document.createElement('div');
          divRowContainer.className = 'themearc image rows-container';
          divRowContainer.appendChild(spanRowContainer);

          imageDiv.appendChild(divRowContainer);
      
          div.style.display = 'none';
        });
      </script>

</body>
</html>
